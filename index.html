<!-- Copyright (C) 2022 NCHU OSA <dromegen@email.nchu.edu.tw>.

  Portions of this page are modifications based on work created and
  shared by Google and used according to terms described in the
  Creative Commons 4.0 Attribution License.
  å­¸æ ¡é–‹æºçš„æŠ½çç³»çµ±ï¼Œå„æœ‰å„ªç¼ºé»ï¼Œæ•™å®˜æŠŠç¨‹å¼ç¢¼ä¿®æ”¹äº†ä¸€ä¸‹çµ¦æˆ‘åƒè€ƒï¼š
  
  https://www.osa.nchu.edu.tw/lottery/
  é€™å€‹æ˜¯æœƒç›´æ¥æŠ“å–googleè¡¨å–®çš„è³‡æ–™ï¼ŒåŠŸèƒ½é™½æ˜¥ï¼Œäº‹å‰éœ€è¦è¨­å®šå¥½googleç¨‹å¼ç¢¼
  
  https://www.osa.nchu.edu.tw/luckydraw/
  é€™å€‹æ˜¯æ‰‹å‹•è²¼å…¥åå–®ï¼ŒåŠŸèƒ½è¼ƒå¤šï¼Œå¯è¨­å®šçé …è·Ÿä¸‹è¼‰åå–®
  
  ä¸Šé¢å…©å€‹æ•™å®˜éƒ½æ”¹æˆæœƒè‡ªå‹•ç¯©é¸é‡è¤‡åå–®ï¼Œå¦‚æœæ‰‹ä¸Šå·²ç¶“æœ‰æ›´å¥½çš„è§£æ±ºæ–¹æ¡ˆé‚£å°±æ›´å¥½äº†ï½
-->

<!DOCTYPE html>
<html>

<head>
  <title>2022 ä¸­èˆˆå¤§å­¸å°¾ç‰™æŠ½ç</title>
  <meta name="description" content="2022 ä¸­èˆˆå¤§å­¸å°¾ç‰™æŠ½ç">
  <meta property="og:image" content="https://www.nchu.edu.tw/favicon.ico">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="robots" content="noindex">
  <!-- é˜²æ­¢ Mobile Device çš„ Zoom in/Out (é™¤äº† Safari 10 ä¸æ”¯æ´) -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="format-detection" content="telephone=no">
  <link rel="icon" href="https://www.nchu.edu.tw/favicon.ico">
  <link rel="apple-touch-icon" href="https://www.nchu.edu.tw/favicon.ico">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
  <script src="https://apis.google.com/js/api.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/js/all.min.js"></script>
  <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
  <!--[if lt IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
  <![endif]-->
</head>

<body>
  <div class="ui top compact menu tabular attached">
    <a class="icon item active" data-tooltip="2022 ä¸­èˆˆå¤§å­¸å°¾ç‰™æŠ½ç" data-position="bottom left">
      <i class="fa fa-ticket" aria-hidden="true"></i>
      <span class="mobilehide">&nbsp;&nbsp;2022 ä¸­èˆˆå¤§å­¸å°¾ç‰™æŠ½ç</span>
    </a>
    <a class="icon item" data-tooltip="è¼¸å…¥è³‡æ–™" data-position="bottom left">
      <i class="fa fa-keyboard"></i>
      <span class="mobilehide">&nbsp;&nbsp;è¼¸å…¥è³‡æ–™</span>
    </a>
    <div class="right menu">
      <a class="icon item" data-tooltip="Google è©¦ç®—è¡¨" data-position="bottom center"
        href="https://docs.google.com/spreadsheets/d/1uPs6CBFz1edahBCSY8HzUTmippmlutsDuhFfvM1tsiw" target="_blank">
        <i><img src="https://i.imgur.com/ky2ykVM.png"></i>
      </a>
      <div id="é¸å–®èªªæ˜æŒ‰éˆ•" class="item ui header" data-tooltip="èªªæ˜" data-position="bottom center">
        <i class="fa fa-question-circle"></i>
      </div>
      <div id="ç™»å…¥æŒ‰éˆ•å€å¡Š" class="icon item" data-tooltip="ç™»å…¥ Google å¸³è™Ÿ ä»¥å­˜å–è©¦ç®—è¡¨" data-position="bottom right">
        <div id="ç™»å…¥æŒ‰éˆ•" class="positive ui button" style="display:none">ç™»å…¥</div>
        <div id="ç™»å‡ºæŒ‰éˆ•" class="google plus ui button compact fade animated Inverted" style="display:none">
          <div class="visible content"><span id="ä½¿ç”¨è€…åç¨±"></span></div>
          <div class="hidden content">
            <h5>ç™»å‡º</h5>
          </div>
        </div>
        <div id="è¼‰å…¥æŒ‰éˆ•" class="massive ui loading button">è¼‰å…¥</div>
      </div>
    </div>
  </div>
  <div class="ui bottom attached segment">
    <form class="ui form">
      <div class="field">
        <label>å­¸è™Ÿ</label>
        <input type="text" name="entry.1" placeholder="è«‹è¼¸å…¥å­¸è™Ÿ">
      </div>
      <div class="field">
        <label>ç³»ç´š</label>
        <input type="text" name="entry.2" placeholder="è«‹è¼¸å…¥ç³»ç´š">
      </div>
      <div class="field">
        <div class="ui checkbox">
          <input type="checkbox" tabindex="0" class="hidden">
          <label>æˆ‘åŒæ„éµå®ˆä½¿ç”¨æ¢æ¬¾</label>
        </div>
      </div>
      <button class="ui button" type="submit">Submit</button>
    </form>
  </div>
  
</div><div id="è‡³é ‚æŒ‰éˆ•" class="cursor_pointer circular massive ui negative icon button" data-tooltip="å›åˆ°æœ€ä¸Šé¢"
data-position="top right" data-inverted><i class="angle double up icon"></i></div>
  <iframe class="ui bottom attached segment"
    src="https://docs.google.com/forms/d/e/1FAIpQLSfMexnj15dM3iVNx0CV5Jq46yBfB51AenZmMiWmPRjo-yIMeA/viewform?embedded=true"
    width="100%" height="100%" frameborder="0" marginheight="0" marginwidth="0">è¼‰å…¥ä¸­â€¦</iframe>
  <pre id="ç‹€æ…‹æ¬„" class="ui container">ğŸ‘‰è³‡æ–™è¼‰å…¥ä¸­â€¦<br></pre>
  <iframe id="èªªæ˜" class="ui bottom attached segment" style="padding:unset" frame-border="0" width="100%" height="100%"
    src="https://hackmd.io/@NCHUIT/GiCS">èªªæ˜è¼‰å…¥ä¸­...</iframe>
  <div class="ui inverted footer bottom text menu">
    <div class="ui container">
      <div class="item">
        Â©Copyright 2022 Office of Student Affairs NCHU All Rights Reserved
      </div>
    </div>
    <div id="é¸æ“‡è¦–çª—" class="ui mini basic modal">
      <div class="ui icon header">
        <i class="list icon"></i>
        é¸æ“‡é¡Œåº«å¹´ä»½
      </div>
      <div class="content">
        å·²å€éš” 2022 å’Œ 2021 å…©å€‹é¡Œåº«ï¼Œè«‹é¸æ“‡
      </div>
      <div class="actions">
        <div id="é¸æ“‡è¦–çª—2022æŒ‰éˆ•" class="ui green ok inverted button">2022</div>
        <div id="é¸æ“‡è¦–çª—2021æŒ‰éˆ•" class="ui red cancel inverted button">2021</div>
      </div>
    </div>
    <div id="éŒ¯èª¤è¨Šæ¯è¦–çª—" class="ui tiny modal">
      <div class="header">âš ï¸éŒ¯èª¤è¨Šæ¯</div>
      <pre id="éŒ¯èª¤è¨Šæ¯è¦–çª—å…§æ–‡" class="content"></pre>
      <div class="actions">
        <div id="éŒ¯èª¤è¨Šæ¯è¦–çª—ç™»å…¥æŒ‰éˆ•" class="ui positive button">é‡æ–°ç™»å…¥</div>
        <div class="ui negative button">é—œé–‰</div>
      </div>
    </div>
    <div id="è¼‰å…¥æç¤º" class="ui active dimmer" style="display:none">
      <div class="ui massive text loader">
        è¼‰å…¥ä¸­<br>
        æœªç™»å…¥è«‹è‡³å³ä¸Šæ–¹ç™»å…¥<br>
        å·²ç™»å…¥é²é²æœªè¼‰å…¥è«‹é»æˆ‘<br>
        æ»‘é¼ ç§»åˆ°ä¸Šæ–¹æŒ‰éˆ•ç„¡åæ‡‰æ™‚<br>
        è«‹éµ <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Delete</kbd><br>
        ä¸¦æ¸…é™¤ç€è¦½å™¨ Cookie
      </div>
    </div>
    <iframe name="formResponse" sandbox="allow-scripts allow-same-origin" tabindex="-1" aria-hidden="true"
      frame-border="0"></iframe>
</body>

<style>
/* 
  @media (prefers-color-scheme: dark) {
    :root {
      color-scheme: dark;
    }

    body,
    #ç‹€æ…‹æ¬„.ui.container {
      background-color: #0d1117 !important;
      color: #abb2bf !important;
    }

    .ui.top.fixed.compact.menu {
      background-color: #161b22 !important;
    }

    .ui.menu>*,
    .ui.menu>*>* {
      color: #ffffffb3 !important;
    }

    #ç‹€æ…‹æ¬„.ui.container {
      border: 1px solid #21262d;
    }
  }
 */
  @media (max-width: 767px) {
    .mobilehide {
      display: none !important;
    }

    .pgo-style-submit-button-pASHWz {
      top: 465px !important;
    }
  }

  .fade.button {
    opacity: unset;
  }

  #é¸å–®èªªæ˜æŒ‰éˆ• i img {
    -webkit-border-radius: 50%;
    border-radius: 50%;
  }

  iframe[name$="formResponse"] {
    width: 1px;
    height: 1px;
    position: absolute;
    top: -100px;
    display: none;
  }

  i img {
    height: 24px !important;
  }

  #è¼‰å…¥æç¤º {
    z-index: 100;
  }

  #ç‹€æ…‹æ¬„ {
    white-space: pre-wrap;
    font-size: large;
  }

  #answer-panel {
    background-repeat: no-repeat !important;
  }

  #answer-panel.attack_modal_m_sprite {
    width: 350px !important;
  }

  #answer-panel-question-content {
    margin-left: unset !important;
    margin-right: unset !important;
  }

  #answer-panel-question-content textarea {
    width: 100%;
    border: 0;
    overflow-y: hidden;
  }

  .choice-button,
  .btn04 {
    user-select: none !important
  }

  .ui.modal p {
    white-space: unset !important;
  }

  .ui.modal,
  #èªªæ˜è¦–çª—.ui.modal {
    top: unset !important;
    left: unset !important;
  }

  .ui.inverted.footer.text.menu {
    background-color: #1b1c1d !important;
  }

  .ui.footer.menu img {
    height: 100% !important;
    width: 100% !important;
  }

  /* from https://www.w3schools.com/howto/howto_js_scroll_to_top.asp */
  #è‡³é ‚æŒ‰éˆ• {
    display: none;
    /* Hidden by default */
    position: fixed;
    /* Fixed/sticky position */
    bottom: 70px;
    /* Place the button at the bottom of the page */
    right: 30px;
    /* Place the button 30px from the right */
    z-index: 100;
    /* Make sure it does not overlap */
  }

  /* from https://www.w3schools.com/howto/tryit.asp?filename=tryhow_css_hide_scrollbar_keep_func */
  .ui.inverted.segment {
    overflow-y: scroll;
    /* Add the ability to scroll */
  }

  /* Hide scrollbar for Chrome, Safari and Opera */
  .ui.inverted.segment::-webkit-scrollbar {
    display: none;
  }

  /* Hide scrollbar for IE, Edge and Firefox */
  .ui.inverted.segment {
    -ms-overflow-style: none;
    /* IE and Edge */
    scrollbar-width: none;
    /* Firefox */
  }
</style>

<script>
  /**
   * Portions of this page are modifications based on work created and
   * shared by Google and used according to terms described in the
   * Creative Commons 4.0 Attribution License.
   */
  var æš«å­˜è³‡æ–™åº« = [], é¡Œåº« = [], ç›®å‰æŠ½å– = [], ç™»å…¥ç‹€æ…‹, æ­£ç¢ºç­”æ¡ˆ;

  const ä½¿ç”¨è€…åç¨± = document.getElementById('ä½¿ç”¨è€…åç¨±'),
    é¸å–®èªªæ˜æŒ‰éˆ• = document.getElementById('é¸å–®èªªæ˜æŒ‰éˆ•'),
    ç™»å…¥æŒ‰éˆ•å€å¡Š = document.getElementById('ç™»å…¥æŒ‰éˆ•å€å¡Š'),
    ç™»å…¥æŒ‰éˆ• = document.getElementById('ç™»å…¥æŒ‰éˆ•'),
    ç™»å‡ºæŒ‰éˆ• = document.getElementById('ç™»å‡ºæŒ‰éˆ•'),
    è¼‰å…¥æŒ‰éˆ• = document.getElementById('è¼‰å…¥æŒ‰éˆ•'),
    è¼‰å…¥æç¤º = document.getElementById('è¼‰å…¥æç¤º'),
    é€å‡ºæŒ‰éˆ• = document.getElementById('é€å‡ºæŒ‰éˆ•'),
    è‡³é ‚æŒ‰éˆ• = document.getElementById('è‡³é ‚æŒ‰éˆ•'),
    ç‹€æ…‹æ¬„ = document.getElementById('ç‹€æ…‹æ¬„'),
    éŒ¯èª¤è¨Šæ¯è¦–çª— = document.getElementById('éŒ¯èª¤è¨Šæ¯è¦–çª—'),
    éŒ¯èª¤è¨Šæ¯è¦–çª—å…§æ–‡ = document.getElementById('éŒ¯èª¤è¨Šæ¯è¦–çª—å…§æ–‡'),
    éŒ¯èª¤è¨Šæ¯è¦–çª—ç™»å…¥æŒ‰éˆ• = document.getElementById('éŒ¯èª¤è¨Šæ¯è¦–çª—ç™»å…¥æŒ‰éˆ•');

  // From https://stackoverflow.com/questions/951021/what-is-the-javascript-version-of-sleep
  const sleep = (ms = 0) => new Promise(r => setTimeout(r, ms));

  /** From https://developers.google.com/sheets/api/quickstart/js  
   *  Called when the signed in status changes, to update the UI
   *  appropriately. After a sign-in, the API is called.
   */
  function æ›´æ–°ç™»å…¥ç‹€æ…‹(isSignedIn = Boolean(gapi.auth2.getAuthInstance().isSignedIn.get()), åªæ˜¯çœ‹çœ‹ = false) {
    è¼‰å…¥æŒ‰éˆ•.style.display = 'none';
    if (isSignedIn) {
      ç™»å…¥æŒ‰éˆ•.style.display = 'none';
      ç™»å‡ºæŒ‰éˆ•.style.display = 'block';
      if (åªæ˜¯çœ‹çœ‹) return isSignedIn;
      é‡è¼‰è³‡æ–™åº«();
    } else {
      ç™»å…¥æŒ‰éˆ•.style.display = 'block';
      ç™»å‡ºæŒ‰éˆ•.style.display = 'none';
    }
    // From https://developers.google.com/identity/sign-in/web/people
    if (gapi.auth2.getAuthInstance().isSignedIn.get()) {
      const profile = gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile();
      ä½¿ç”¨è€…åç¨±.innerHTML = profile.getName();
      é¸å–®èªªæ˜æŒ‰éˆ•.innerHTML = `<i><img src="${profile.getImageUrl()}"></i>`;
      ç™»å…¥æŒ‰éˆ•å€å¡Š.setAttribute("data-tooltip", "å·²ç™»å…¥ " + profile.getEmail());
    } else {
      ä½¿ç”¨è€…åç¨±.innerHTML = "ç™»å‡º";
      é¸å–®èªªæ˜æŒ‰éˆ•.innerHTML = `<i class="fa fa-question-circle"></i>`;
      ç™»å…¥æŒ‰éˆ•å€å¡Š.setAttribute("data-tooltip", "ç™»å…¥ Google å¸³è™Ÿ ä»¥å­˜å–è©¦ç®—è¡¨");
    }
    return isSignedIn;
  }

  // From https://stackoverflow.com/a/12646864/13189986
  function æ‰“äº‚é™£åˆ—(é™£åˆ— = []) {
    for (let i = é™£åˆ—.length - 1; i > 0; i--) {
      let j = Math.floor(Math.random() * (i + 1));
      [é™£åˆ—[i], é™£åˆ—[j]] = [é™£åˆ—[j], é™£åˆ—[i]];
    }
    return é™£åˆ—;
  }

  function æŠ½ç() {
    è¼‰å…¥æç¤º.style.display = 'flex';
    $('#é€å‡ºæŒ‰éˆ•').hide();
    $('#æŠ½çæŒ‰éˆ•').show();
    if (æš«å­˜è³‡æ–™åº«.length < 1 && !æ›´æ–°ç™»å…¥ç‹€æ…‹()) ç™»å…¥();
    ç›®å‰æŠ½å– = æš«å­˜è³‡æ–™åº«.pop();
    // è¼¸å…¥æ¡†[0].value = è¼¸å…¥æ¡†[0].innerHTML = ç›®å‰æŠ½å–[0];
    æ­£ç¢ºç­”æ¡ˆ = String(ç›®å‰æŠ½å–[1]);
    ç›®å‰æŠ½å– = æ‰“äº‚é™£åˆ—(ç›®å‰æŠ½å–.slice(1));
    // for (const å…ƒç´  of è¼¸å…¥æ¡†.slice(1))
    //   å…ƒç´ .value = å…ƒç´ .innerHTML = ç›®å‰æŠ½å–.pop();
    // for (const i in è¼¸å…¥æ¡†) ç›®å‰æŠ½å–[i] = è¼¸å…¥æ¡†[i].innerHTML;
    è¼‰å…¥æç¤º.style.display = 'none';
  }

  async function æª¢æŸ¥ç­”æ¡ˆ(é¸é … = new HTMLElement()) {
    if (é€å‡ºæŒ‰éˆ•.style.display == 'none') {
      if (æ­£ç¢ºç­”æ¡ˆ === é¸é ….value || æ­£ç¢ºç­”æ¡ˆ === é¸é ….innerHTML) {
        éŒ¯é¡ŒéŸ³æ•ˆ.pause();
        éŸ³æ•ˆæ’­æ”¾(æ­£è§£éŸ³æ•ˆ);
        await sleep(50);
        if (confirm('â­•ç­”å°å•¦ï¼\n\n' + æ­£ç¢ºç­”æ¡ˆ + '\n\næŒ‰ä¸‹å–æ¶ˆ(Esc)è¿”å›ã€ç¢ºå®š(Enter)æŠ½ç'))
          æŠ½ç();
      } else {
        æ­£è§£éŸ³æ•ˆ.pause();
        éŸ³æ•ˆæ’­æ”¾(éŒ¯é¡ŒéŸ³æ•ˆ);
      }
    } else {
      for (const å…ƒç´  of è¼¸å…¥æ¡†.slice(1)) {
        if (å…ƒç´ .value == é¸é ….value || å…ƒç´ .innerHTML == é¸é ….innerHTML) {
          [è¼¸å…¥æ¡†[1].value, è¼¸å…¥æ¡†[1].innerHTML, é¸é ….value, é¸é ….innerHTML] =
            [é¸é ….value, é¸é ….innerHTML, è¼¸å…¥æ¡†[1].value, è¼¸å…¥æ¡†[1].innerHTML];
        }
      }
    }
  }

  // From https://developers.google.com/sheets/api/quickstart/js
  function ç‹€æ…‹æ¬„çºŒå¯«(è¨Šæ¯ = '') {
    ç‹€æ…‹æ¬„.appendChild(document.createTextNode(è¨Šæ¯ + '\n'));
    return è¨Šæ¯;
  }

  function é‡è¨­ç‹€æ…‹æ¬„(è¨Šæ¯ = `ğŸ‘‰å…±è¼‰å…¥${é¡Œåº«.length}ç­†(æ–°åˆ°èˆŠ)`) {
    ç‹€æ…‹æ¬„.innerHTML = è¨Šæ¯ + '\n';
    return è¨Šæ¯;
  }

  function å½ˆå‡ºéŒ¯èª¤è¨Šæ¯(è¨Šæ¯ = '') {
    é‡è¨­ç‹€æ…‹æ¬„('âš ï¸éŒ¯èª¤è¨Šæ¯');
    ç‹€æ…‹æ¬„çºŒå¯«(è¨Šæ¯);
    éŒ¯èª¤è¨Šæ¯è¦–çª—å…§æ–‡.innerHTML = è¨Šæ¯;
    $('#éŒ¯èª¤è¨Šæ¯è¦–çª—').modal('show');
    éŒ¯èª¤è¨Šæ¯è¦–çª—.style.left = 'unset';
    return è¨Šæ¯;
  }

  // From https://developers.google.com/sheets/api/quickstart/js
  async function é‡è¼‰è³‡æ–™åº«() {
    è¼‰å…¥æç¤º.style.display = 'flex';
    é‡è¨­ç‹€æ…‹æ¬„();
    gapi.client.sheets.spreadsheets.values.get({
      spreadsheetId: '1uPs6CBFz1edahBCSY8HzUTmippmlutsDuhFfvM1tsiw',
      range: 'åŒå­¸è³‡æ–™!B2:F',
    }).then(function (response) {
      è¼‰å…¥æç¤º.style.display = 'flex';
      var range = response.result;
      if (range.values.length > 0) {
        é¡Œåº« = æš«å­˜è³‡æ–™åº« = range.values;
        é‡è¨­ç‹€æ…‹æ¬„();
        é¡Œåº«.reverse();
        const æ¬„ä½æ¨™é¡Œ = ['ç§‘ç³»', 'å§“å', 'å­¸è™Ÿ', 'é›»è©±', 'åº§ä½'];
        for (const row of é¡Œåº«){
          for (const i in æ¬„ä½æ¨™é¡Œ)
            ç‹€æ…‹æ¬„çºŒå¯«('\n' + æ¬„ä½æ¨™é¡Œ[i] + ': ' + row[i]);
          ç‹€æ…‹æ¬„çºŒå¯«('\n');
        }
        æ‰“äº‚é™£åˆ—(æš«å­˜è³‡æ–™åº«);
        æŠ½ç();
      } else å½ˆå‡ºéŒ¯èª¤è¨Šæ¯('No data found.');
    }, å›æ‡‰ => å½ˆå‡ºéŒ¯èª¤è¨Šæ¯('Error: ' + å›æ‡‰.result.error.message));
  }

  async function ç™»å…¥() {
    è¼‰å…¥æç¤º.style.display = 'flex';
    è¼‰å…¥æŒ‰éˆ•.style.display = 'block';
    ç™»å…¥æŒ‰éˆ•.style.display = 'none';
    if (gapi.auth2.getAuthInstance().isSignedIn.get())
      gapi.auth2.getAuthInstance().signOut();
    try {
      await new Promise(r => gapi.auth2.getAuthInstance().signIn());
    } catch (e) { // TO-DO
      console.log(e);
    }
    gapi.auth2.getAuthInstance().isSignedIn.listen(æ›´æ–°ç™»å…¥ç‹€æ…‹);
    æ›´æ–°ç™»å…¥ç‹€æ…‹();
  }

  function æ¸…é™¤è¼¸å…¥æ¡†() {
    document.forms[0].reset();
    for (input of document.forms[0])
      input.value = input.innerHTML = null;
    $('#é€å‡ºæŒ‰éˆ•').hide();
    $('#æŠ½çæŒ‰éˆ•').show();
  }

  function é€å‡ºé¡Œç›®() {
    if (!gapi.auth2.getAuthInstance().isSignedIn.get()) return å½ˆå‡ºéŒ¯èª¤è¨Šæ¯('æœªç™»å…¥');
    if (é€å‡ºæŒ‰éˆ•.style.display == 'none' || æª¢æŸ¥é¡Œç›®()) return;
    else if (confirm(è¼¸å…¥æ¡†[1].value + '\n\næ˜¯æ­£ç¢ºç­”æ¡ˆå—?\n\næŒ‰ä¸‹ç¢ºå®š(Enter)é€è‡³ Google è©¦ç®—è¡¨')) {
      document.forms[0].submit();
      $('#é€å‡ºæŒ‰éˆ•').hide()
      $('#æŠ½çæŒ‰éˆ•').show();
      æ›´æ–°ç™»å…¥ç‹€æ…‹();
    }
  }

  function æª¢æŸ¥é¡Œç›®() {
    const value = è¼¸å…¥æ¡†[0].value;
    const innerHTML = è¼¸å…¥æ¡†[0].innerHTML;
    for (const row of é¡Œåº«)
      if ((value && value.length > 5
        && String(row[0]).indexOf(value) > -1)
        || (innerHTML && innerHTML.length > 5
          && String(row[0]).indexOf(innerHTML) > -1)) {
        if (!confirm(`æœ‰é€™å€‹é¡Œç›®äº†ï¼Œæª¢æŸ¥æ­£ç¢ºç­”æ¡ˆç„¡èª¤?

â­•æ­£ç¢ºç­”æ¡ˆ: ${row[1]}

éŒ¯èª¤ç­”æ¡ˆ1: ${row[2]}
éŒ¯èª¤ç­”æ¡ˆ2: ${row[3]}
éŒ¯èª¤ç­”æ¡ˆ3: ${row[4]}

æŒ‰ä¸‹å–æ¶ˆ(Esc)ä»¥é—œé–‰ï¼Œç¢ºå®š(Enter)ä»¥ç·¨è¼¯/é€å‡ºä¿®æ”¹
ğŸ‘‰è¨˜å¾—åˆ°è©¦ç®—è¡¨åˆªæ‰åŸä¾†éŒ¯çš„ï¼Œè‡ªå‹•åˆªé™¤é–‹ç™¼ä¸­...`)) return true;
        else break;
      }
    return false;
  }

  // EventListener
/* 
  document.getElementById('æ¸…é™¤æŒ‰éˆ•').onclick = æ¸…é™¤è¼¸å…¥æ¡†;
  document.getElementById('æŠ½çæŒ‰éˆ•').onclick = æŠ½ç;
  document.getElementById('é¸å–®èªªæ˜æŒ‰éˆ•').onclick =
    document.getElementById('é©šå˜†è™ŸæŒ‰éˆ•').onclick = e => $('#èªªæ˜è¦–çª—').modal('show');

  é€å‡ºæŒ‰éˆ•.onclick = é€å‡ºé¡Œç›®;
  æŒ‰éˆ•A.onclick = e => æª¢æŸ¥ç­”æ¡ˆ(è¼¸å…¥æ¡†[1]);
  æŒ‰éˆ•B.onclick = e => æª¢æŸ¥ç­”æ¡ˆ(è¼¸å…¥æ¡†[2]);
  æŒ‰éˆ•C.onclick = e => æª¢æŸ¥ç­”æ¡ˆ(è¼¸å…¥æ¡†[3]);
  æŒ‰éˆ•D.onclick = e => æª¢æŸ¥ç­”æ¡ˆ(è¼¸å…¥æ¡†[4]);
 */
  ç™»å…¥æŒ‰éˆ•.onclick = éŒ¯èª¤è¨Šæ¯è¦–çª—ç™»å…¥æŒ‰éˆ•.onclick = ç™»å…¥;

  ç™»å‡ºæŒ‰éˆ•.onclick = e => {
    é‡è¨­ç‹€æ…‹æ¬„('æ‚¨å·²ç™»å‡º');
    è¼‰å…¥æŒ‰éˆ•.style.display = 'block';
    æš«å­˜è³‡æ–™åº« = é¡Œåº« = ç›®å‰æŠ½å– = æ­£ç¢ºç­”æ¡ˆ = [];
    æ¸…é™¤è¼¸å…¥æ¡†();
    gapi.auth2.getAuthInstance().signOut();
    // From https://stackoverflow.com/questions/179355/clearing-all-cookies-with-javascript
    for (const cookie of document.cookie.split(";")) { // Clearing all cookies
      const eqPos = cookie.indexOf("=");
      const name = eqPos > -1 ? cookie.substring(0, eqPos) : cookie;
      document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
    }
    æ›´æ–°ç™»å…¥ç‹€æ…‹(false);
  };

  è¼‰å…¥æŒ‰éˆ•.onclick = è¼‰å…¥æç¤º.onclick = e => {
    if (æ›´æ–°ç™»å…¥ç‹€æ…‹()) é‡è¼‰è³‡æ–™åº«();
  };

  // When the user clicks on the button, scroll to the top of the document
  è‡³é ‚æŒ‰éˆ•.onclick = e => {
    document.body.scrollTop = 0;
    document.documentElement.scrollTop = 0;
  };

  onfocus = e => æ›´æ–°ç™»å…¥ç‹€æ…‹(gapi.auth2.getAuthInstance().isSignedIn.get(), true);
  onblur = e => {
    ç™»å…¥æŒ‰éˆ•.style.display = ç™»å‡ºæŒ‰éˆ•.style.display = 'none';
    è¼‰å…¥æŒ‰éˆ•.style.display = 'block';
  }
  // from https://www.w3schools.com/howto/howto_js_scroll_to_top.asp
  // When the user scrolls down 20px from the top of the document, show the button
  onscroll = e => {
    if (document.body.scrollTop > innerHeight
      || document.documentElement.scrollTop > innerHeight) {
      è‡³é ‚æŒ‰éˆ•.style.display = "block";
    } else {
      è‡³é ‚æŒ‰éˆ•.style.display = "none";
    }
  };

  // From https://developers.google.com/sheets/api/quickstart/js
  // On load, called to load the auth2 library and API client library.
  gapi.load('client:auth2', e => {
    // Initializes the API client library and sets up sign-in state listeners.
    gapi.client.init({
      // Client ID and API key from the Developer Console
      clientId: '289902636224-oro06s681gdgk1kqrv8o1oca2shocfr4.apps.googleusercontent.com',
      apiKey: 'AIzaSyCRfe3-dnm9GGMH_PFm9m5WHBMb_8U9HXY',
      /**Array of API discovery doc URLs for APIs used by the quickstart */
      discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
      /**Authorization scopes required by the API; multiple scopes can be
       * included, separated by spaces. */
      scope: "https://www.googleapis.com/auth/spreadsheets.readonly"
    }).then(e => {
      // Listen for sign-in state changes.
      gapi.auth2.getAuthInstance().isSignedIn.listen(æ›´æ–°ç™»å…¥ç‹€æ…‹);
      // Handle the initial sign-in state.
      if (!æ›´æ–°ç™»å…¥ç‹€æ…‹()) ç™»å…¥();
    }, éŒ¯èª¤ => å½ˆå‡ºéŒ¯èª¤è¨Šæ¯(JSON.stringify(éŒ¯èª¤, null, 2)));
  });
</script>

</html>